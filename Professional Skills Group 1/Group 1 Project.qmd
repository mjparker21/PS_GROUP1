---
title: "Pro Skills Group Project"
author: "Group 1"
format: html
editor: visual
---

## Introduction

Steadily increasing weight is an indicator of a healthy child. Weight change differs between children, so it is of interest to know what factors influence a child's weight. A study conducted at the Queen Mothers hospital in Glasgow sampled 127 new born babies gathered the following variables:

`Wt24`  - The child's weight at 24 months (numerical variable, continuous).

`Wt1`  - The child's weight at 1 month (numerical variable, continuous).

`Solids`  - The age at which the child was first introduced to solid food (numerical variable, discrete).

`Sex` - The child's sex (categorical variable, with categories Male or Female).

The goal of this report is to examine which variables influence `Wt24` first by assessing how well `Wt24` can be predicted using a linear model with `Wt1` as an explanatory variable. We then see if the model if improved by adding `Sex` or `Solids` to the model. Finally, we see if there is any evidence that the difference in weight (`Wt24`  - `Wt1`) is different for male and female children.

@sec-exploratory consists of exploratory analysis explores the potential relationships between variables by use of data visualisation and numerical summaries. @sec-formalanalysis uses linear regression modelling to answer the questions of interest. @sec-conclusion summarisises the findings of the report as well as discuss some limitations of the study.

```{r}
#| echo: false
#| warning: false
#| message: false
library(corrr)
library(ggplot2)
library(tidyverse)
library(gt)
library(gridExtra)
library(MASS)
library(patchwork)
library(moderndive)
library(knitr)
library(kableExtra)
data <- read.csv("~/Downloads/project1-growth-wt.csv")

```

## Exploratory Analysis {#sec-exploratory}

```{r}
#| echo: false
#| warning: false
#| fig-cap: Relationship between Wt24 and numerical explanatory variables coloured by sex
#| fig-subcap: 
#| - Relationship between weight at 24 months and weight at 1 month, coloured by sex
#| - Relationship between weight at 24 months and age at introduction to solids, coloured by sex
#| label: fig-scat-wt24-wt1
#| layout-ncol: 2
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
#| fig-cap-location: top
PlotWt1 <-  ggplot(data, aes(x = Wt1, y = Wt24, color = Sex)) +
           geom_point() +
          labs(x = "Weight at 1 month (kg)", y = "Weight at 24 months (kg)", color = "Sex") +             theme_minimal()

PlotSolids <- ggplot(data, aes(x = Solids, y = Wt24, color = Sex)) +
               geom_point() +
                geom_smooth(method = "lm", se = FALSE) + 
                labs(
                 x = "Age (Months) at Introduction to Solids",
                  y = "Weight at 24 Months (kg)",
                  color = "Sex") +
                  theme_minimal()

PlotWt1
PlotSolids
```

@fig-scat-wt24-wt1 shows the relationship between the response `Wt24` and explanatory variables, namely `Wt1` and `Solids`. From @fig-scat-wt24-wt1-1 it appears that there is a positive, moderate to strong linear relationship between `Wt24` and `Wt1`. Moreover, with the exception of a few points there appears to be a distinction by `Sex` with female children having lower weight and male children having a higher weight. @fig-scat-wt24-wt1-2 illustrates the relationship between `Wt24` and `Solids`, with separate regression lines for males and females. The plot suggests a moderate negative linear relationship for females, indicating that introducing solids later may be associated with lower weight at 24 months. In contrast, the regression line for males remains relatively flat, suggesting a weak relationship between `Wt24` and `Solids` for male children.

```{r}
#| echo: false
#| warning: false
#| fig-cap: Boxplots of weight at 24 months and weight at 1 month by sex
#| fig-subcap: 
#| - Distribution of weight at 1 month by sex
#| - Distribution of wight at 24 months by sex
#| label: fig-boxplots
#| layout-ncol: 2
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
#| fig-cap-location: top

Wt24.boxplot <- ggplot(data, aes(x = Sex, y = Wt24, fill = Sex)) +
  geom_boxplot(alpha = 0.7) +
  labs(x = "Sex", y = "Weight (kg)") +
  theme_minimal()

Wt1.Boxplot <- ggplot(data, aes(x = Sex, y = Wt1, fill = Sex)) +
  geom_boxplot(alpha = 0.7) +
  labs(x = "Sex", y = "Weight (kg)") +
  theme_minimal()
Wt1.Boxplot
Wt24.boxplot
```

@fig-boxplots-1 presents a boxplot illustrating the distribution of `Wt1` categorised by `Sex`. The plot suggests that male children tend to have a slightly higher median weight compared to females, with a slightly wider range of values. The presence of outliers, particularly among female infants, indicates some variation in early weight distribution. @fig-boxplots-2 extends this analysis to `Wt24`, where the observed trend continues. Male children exhibit a higher median weight than female children, and the overall distribution of weight is more spread out for males. The increased variation, particularly in the upper range, suggests that male children may experience a broader range of growth trajectories compared to females.

```{r}
#| echo: false
#| warning: false
cors.male <- data |> filter(,Sex=="Male") |> correlate(,diagonal = 1)
cors.female <- data |> filter(,Sex=="Female") |> correlate(,diagonal = 1)
```

```{r}
#| echo: false
#| warning: false
#| tbl-cap: Correlations between numerical variables by sex
#| tbl-subcap: 
#|  - Correlations for numerical variables for male children
#|  - Correlations for numerical variables for female children
#| layout-ncol: 2
#| tbl-cap-location: top
#| label: tbl-corrs

# Male table
male_table <- cors.male |> 
  gt() |> 
  fmt_number(decimals = 2) |> 
  tab_style(style = cell_text(weight = "bold"), locations = cells_column_labels())

# Female table
female_table <- cors.female |> 
  gt() |> 
  fmt_number(decimals = 2) |> 
  tab_style(style = cell_text(weight = "bold"), locations = cells_column_labels())

# Print tables using layout-ncol: 2 to automatically place them side by side
male_table
female_table
```

@tbl-corrs shows the correlation between numerical variables for male and female children. For male children @tbl-corrs-1 highlights that for male children `Wt1` and `Wt24` are moderately, positivley correlated, whereas `Solids` against `Wt24` and `Wt1` are weakly negatively correlated. This is slightly different for female children as from @tbl-corrs-2 there appears to be a higher positive correlation between `Wt24` and `Wt1`. Additionally, there appears to be a moderate negative correlation between `Solids` and `Wt24` for female children and a weak-moderate correlation between `Solids` and `Wt1`.

```{r}
#| echo: false
#| label: tbl-summary
#| tbl-cap:  Mean, median and standard deviation (sd) Wt24, Wt1 and Solids by sex.
data |>
   summarize('Wt24.Mean' = mean(Wt24),
             'Wt24.Median' = median(Wt24),
             'Wt24.sd' = sd(Wt24),
             'Wt1.Mean' = mean(Wt1),
             'Wt1.Median' = median(Wt1),
             'Wt1.sd' = sd(Wt1),
             'Solids.Mean' = mean(Solids),
             'Solids.Median' = median(Solids),
             'Solids.sd' = sd(Solids),
             .by = Sex) |>
 gt() |> 
  fmt_number(decimals=2) |>
  tab_spanner(
    label = "Wt24",
    columns = c(Wt24.Mean, Wt24.Median,Wt24.sd)
  ) |>
  tab_spanner(
    label = "Wt1",
    columns = c(Wt1.Mean, Wt1.Median,Wt1.sd)
  ) |>
    tab_spanner(
    label = "Solids",
    columns = c(Solids.Mean, Solids.Median, Solids.sd)
  ) |>
  cols_label(
    Wt24.Mean = html("Mean"),
    Wt24.Median = html("Median"),
    Wt24.sd = html("Std.Dev"),
    Wt1.Mean = html("Mean"),
    Wt1.Median = html("Median"),
    Wt1.sd = html("Std.Dev"),
    Solids.Mean = html("Mean"),
    Solids.Median = html("Median"),
    Solids.sd = html("Std.Dev")
  )
```

@tbl-summary shows the mean, median and standard deviation of `Wt24`, `Wt1` and `Solids` by `Sex`. On average, there appears to be a slight difference in `Wt24` and `Wt1`by `Sex`. There does not appear to be a difference in `Solids` by `Sex` on average.

## Formal Analysis  {#sec-formalanalysis}

## Conclusion {#sec-conclusion}

## References

-   <https://www.nhs.uk/conditions/baby/babys-development/height-weight-and-reviews/baby-height-and-weight/>

-   <https://www.babycenter.com/baby/baby-development/average-weight-and-growth-chart-for-babies-toddlers-and-beyo_10357633>
